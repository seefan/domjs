/*! domjs 2018-08-14 */

!function(e,t,n){"use strict";e.isInit=!1,e.debug=!1,e.disableError=!1,e.optAjax="undefined"!=typeof jQuery&&jQuery,e.root="",e.apiroot="",e.initFunction=[],e.readyFunction=[],e.animationBind=!1,e.enableJsonp=!1,e.animationBindMin=5,e.hideBind=!0,e.bindSelf=!0,e.init=function(){if(!e.isInit){e.isInit=!0,e.debug||(t.oncontextmenu=function(){return!1});for(var n=0;n<e.initFunction.length;n++)e.initFunction[n](e);e.bindSelf&&e.bindData("domjs",e);for(var r=0;r<e.readyFunction.length;r++)!function(e){e.executed||(e.executed=!0,setTimeout(function(){e.callback()},1))}(e.readyFunction[r])}},e.ready=function(t){if("function"==typeof t){var n={executed:!1,callback:t};if(e.isInit)return n.callback(),void(n.executed=!0);e.readyFunction.push(n)}};var r=function(){return!(!/complete|loaded|interactive/.test(t.readyState)||!t.body)&&(e.init(),!0)},i=function(){r()||setTimeout(i,5)};r()||(t.addEventListener?t.addEventListener("DOMContentLoaded",function(){r()},!1):setTimeout(i,5))}(window.domjs={},document),function(e,t,n,r){e.insertAfter=function(e,t){var n=t.parentNode;n&&(n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling))},e.setValue=function(t,n){e.isPlainObject(n)&&(n=JSON.stringify(n)),e.each(e.querySelectorAll(t),function(t,r){e.bindElementValue(r,n)},!0)},e.bindElementValue=function(e,t){switch(e.tagName){case"IMG":e.src=t;break;case"INPUT":if("checkbox"===e.type)for(vs=new String(t).split(","),j=0;j<vs.length;j++)vs[j]===e.value&&(e.checked=!0);else if("radio"===e.type){for(vs=new String(t).split(","),j=0;j<vs.length;j++)if(vs[j]===e.value){e.checked=!0;break}}else e.value=t;break;case"SELECT":for(i=0;i<e.options.length;i++)if(e.options[i].value===t){e.options[i].selected=!0;break}break;default:void 0!==e.innerHTML?e.innerHTML=t:e.value=t}},e.setDisabled=function(t,n){void 0===n&&(n=!0),e.each(e.querySelectorAll(t),function(e,t){t.disabled=n},!0)},e.setHide=function(t,n){void 0===n&&(n=!0),e.each(e.querySelectorAll(t),function(t,r){n?"none"!=r.style.display&&(r.style.display="none"):("none"==r.style.display&&(r.style.display=""),e.removeClass(r,"hide"))},!0)},e.timedCallback=function(t,n){n&&!0===n(t)&&(t=0),--t>=0&&setTimeout(function(){e.timedCallback(t,n)},1e3)},e.each=function(e,t){if(e&&t){var n,r=0,i=e.length;if(void 0===i||"function"==typeof e){for(n in e)if(!1===t.call(e[n],n,e[n]))break}else for(;r<i&&!1!==t.call(e[r],r,e[r++]););return e}},e.isArray=Array.isArray||function(e){return e instanceof Array},e.extend=function(t){var n,r,i;for(n=1;n<arguments.length;n++)if(i=arguments[n],e.isPlainObject(i))for(r in i)null!==i[r]&&void 0!==i[r]&&(t[r]=i[r]);return t},e.log=function(){if(window.domjs.debug)for(var e in arguments)console.log(JSON.stringify(arguments[e]))},e.query=function(t,n){e.query_args||(e.query_args=e.getUrlQuery());var r=e.query_args[t];return void 0===r||""===r?n:r},e.hash=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t},e.eval=function(e){return new Function("return "+e)()},e.isPlainObject=function(e){return!!e&&"[object Object]"===Object.prototype.toString.call(e)},e.startWith=function(e,t){return"string"==typeof e&&0===e.indexOf(t)},e.isNumber=function(e){var t=/^(-?\d+)(\.\d+)?/;return null!==e.match(t)},e.gotoUrl=function(){var e="",t=0;for(arguments.length>0&&(e=arguments[t]),-1!=e.indexOf("?")?e+="&":e+="?",t=1;t<arguments.length-1;t+=2)e+=arguments[t]+"="+encodeURIComponent(arguments[t+1])+"&";n.location.href=e},e.getUrlQuery=function(){var e={},t=n.location.search;if(t&&t.length>1){var r=(t=t.substring(1)).indexOf("#");-1!=r&&(t=t.substring(0,r));for(var i=t.split("&"),a=0;a<i.length;a++)if(-1!=(r=i[a].indexOf("="))){var o=i[a].substring(0,r);if(o){var u=i[a].substring(r+1);u&&(e[o]=decodeURIComponent(u))}}}return e},e.setUrlQuery=function(e){var t="";for(var r in e)e[r]&&(t+=r+"="+encodeURIComponent(e[r])+"&");n.location.search=t},e.eval=function(e){return new Function("return "+e)()},e.addClass=function(e,t){if(e.classList)e.classList.contains(t)||e.classList.add(t);else{var n=e.className;if(n){for(var r=n.split(" "),i=!1,a=0;a<r.length;a++)r[a]==t&&(i=!0);i||r.push(t),n=r.join(" ")}else n=t;e.className=n}},e.removeClass=function(e,t){if(e.classList)e.classList.contains(t)&&e.classList.remove(t);else{var n=e.className;if(n){var r=n.split(" ");n="";for(var i=0;i<r.length;i++)r[i]!=t&&(n+=r[i]);e.className=n}}},e.querySelectorAll=function(e){if(t.querySelectorAll)return t.querySelectorAll(e)},!t.querySelectorAll&&jQuery&&(e.querySelectorAll=function(e){var t=[];return jQuery(e).each(function(e,n){t.push(n)}),t}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(window.domjs.util={},document,window),function(e){e.alert=function(e){window.alert(e)},e.toast=function(e){window.alert(e)},e.confirm=function(e,t){window.confirm(e)&&t()},e.back=function(e){document.referrer&&!0===e?window.location.href=document.referrer:window.history.back()},e.on=function(e,t,n,r,i){"undefined"!=typeof jQuery&&jQuery(e).on(t,n,r,i)},e.go=function(t,n){e.util.gotoUrl(t,n)},e.reload=function(){window.location.reload()},e.showLogin=function(){window.location.href="login.html"},e.closeLogin=function(){e.back(!0)},e.error=function(t){t&&t.relogin?e.showLogin():t&&"string"==typeof t.error?e.toast(t.error):"string"==typeof t?e.toast(t):e.debug&&e.toast("数据请求出错，请检查网络是否可以正常访问！")}}(window.domjs),function(e,t,n){n.enableRetry=!0,n.post=function(r,i,a,o,u){if(!1!==e.optAjax){e.util.isPlainObject(i)||(i={});var s={};s.url=r,s.type="POST",s.dataType="json",s.data=i,s.async=!0,s.error=function(t){e.util.log("请求"+r+"错误，问题是："+t.statusText+"，状态："+t.status+"，返回："+t.responseText),!0===u?((t={}).error="网络访问出错，请稍后再试。",t.reset=!0,"function"==typeof o?o(t):e.disableError||e.error(t)):n.enableRetry&&n.post(r,i,a,o,!0)},s.success=function(n){"string"==typeof n&&""!==n&&(n=t.eval("("+n+")")),!n||n.error&&0!==n.error&&"0"!==n.error?"function"==typeof o?o(n):e.error(n):a&&a(n)},e.optAjax.ajax(s)}else e.error("没有配置ajax执行类")}}(window.domjs,window.domjs.util,window.domjs.http={}),function(e,t,n,r){t.request={},t.noop=function(){};var i=function(e,t,r,a){var o=n.isArray(t),u=n.isPlainObject(t);n.each(t,function(t,s){a&&(t=r?a:a+"["+(u||n.isPlainObject(s)||n.isArray(s)?t:"")+"]"),!a&&o?e.add(s.name,s.value):n.isArray(s)||!r&&n.isPlainObject(s)?i(e,s,r,t):e.add(t,s)})},a=function(e){e.data&&"string"!=typeof e.data&&(e.data=t.param(e.data,e.traditional)),e.url=o(e.url,e.data),e.data=void 0},o=function(e,t){return""===t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")};t.ajaxSettings={success:t.noop,error:t.noop,complete:t.noop,context:null,timeout:0,id:0};var u=function(e,t){t.success&&t.success.call(t.context,e,"success"),l("success",t)},s=function(e,t,n){n.error&&n.error.call(n.context,t,e),l(t,n)},l=function(e,t){t.complete&&t.complete.call(t.context,e)};t.param=function(e,t){var n=[];return n.add=function(e,t){"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||this.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},i(n,e,t),n.join("&").replace(/%20/g,"+")},t.ajax=function(e,r){"object"==typeof e&&(r=e,e=void 0);var i=r||{};i.url=e||i.url;for(var u in t.ajaxSettings)void 0===i[u]&&(i[u]=t.ajaxSettings[u]);if(i.id=n.hash(i.url),i.data||(i.data={}),i.data.jsonp_callback_id=i.id,i.data.jsonp_callback="app.jsonp.callback",a(i),i.url=o(i.url,"_="+(new Date).getTime()),i.timeout=3e4,i.timeout>0&&setTimeout(function(){delete t.request[i.id];var e=document.getElementById(i.id);e&&document.body.removeChild(e),s(null,"timeout",this)},i.timeout),!t.request[i.id]){t.request[i.id]=r;var l=document.createElement("script");l.id=i.id,l.src=i.url,document.body.appendChild(l)}},t.callback=function(e,n){var r=t.request[e];if(r){u(n,r),delete t.request[e];var i=document.getElementById(e);i&&document.body.removeChild(i)}},t.get=function(r,i,a,o){e.util.isPlainObject(i)||(i={});var u={};u.url=r,u.data=i,u.error=function(t){e.util.log("请求"+r+"错误，jsonp语法未成功。"),e.disableError||((t={}).error="网络访问出错，请稍后再试。",t.reset=!0,"function"==typeof o?o(t):e.error(t))},u.success=function(t){"string"==typeof t&&""!==t&&(t=n.eval("("+t+")")),!t||t.error&&0!==t.error&&"0"!==t.error?"function"==typeof o?o(t):e.error(t):a&&a(t)},t.ajax(u)}}(window.domjs,window.domjs.jsonp={},window.domjs.util),function(e,t,n){function r(t,n){var r;(r=void 0!==t.f_datafilter?t.f_datafilter(n):n.data)&&(e.util.isArray(r)?r.length>e.animationBindMin?e.bindRepeatData(t.id,r,t.isAppend,t.isAnimation):e.bindRepeatData(t.id,r,t.isAppend):t.id?e.bindData(t.id,r):e.bindData(r)),void 0!==t.f_success&&t.f_success(r)}e.ajaxBind=function(t,n,r,i,a,o){return void 0===n&&(n=t,t=""),e.ajax(n,r).bind(t).filter(i).success(a).error(o)},e.ajax=function(i,a){""!==a&&void 0!==a||(a=e.util.getUrlQuery());var o={id:"",url:i,param:a,f_datafilter:void 0,f_success:void 0,f_error:function(t){e.error(t)},isAppend:!1,isAnimation:e.animationBind};return o.filter=function(e){return"function"==typeof e&&(this.f_datafilter=e),this},o.success=function(e){return"function"==typeof e&&(this.f_success=e),this},o.error=function(e){return"function"==typeof e&&(this.f_error=e),this},o.bind=function(e){return this.id=e,this},o.append=function(e){return this.isAppend=!0===e,this},o.animation=function(e){return this.isAnimation=!0===e,this},e.util.isPlainObject(o.param)||(o.param={}),e.login&&(o.param.token=e.login.token),e.enableJsonp?n.get(e.root+e.apiroot+o.url,o.param,function(e){r(o,e)},function(e){o.f_error(e)}):t.post(e.root+e.apiroot+o.url,o.param,function(e){r(o,e)},function(e){o.f_error(e)}),o},e.postForm=function(t,n,r,i,a){"function"==typeof r&&(a=i,i=r,r={}),e.util.isPlainObject(r)||(r={});var o=e.form.getFormParam(t,!0);if(void 0!==o){for(var u in r)""!==u&&r[u]&&(o[u]=r[u]);e.post(n,o,i,a)}},e.post=function(t,n,r,i){"function"==typeof n&&(i=r,r=n,n={}),""!==n&&void 0!==n||(n=e.util.getUrlQuery()),e.util.isPlainObject(n)||(n={}),e.login&&(n.token=e.login.token),"function"!=typeof i&&(i=e.error),e.http.post(e.root+e.apiroot+t,n,r,i)},e.get=function(r,i,a,o){"function"==typeof i&&(o=a,a=i,i={}),""!==i&&void 0!==i||(i=e.util.getUrlQuery()),e.util.isPlainObject(i)||(i={}),e.login&&(i.token=e.login.token),"function"!=typeof o&&(o=e.error),e.enableJsonp?n.get(e.root+e.apiroot+r,i,a,o):t.post(e.root+e.apiroot+r,i,a,o)},e.iBind=function(t,n,r,i){return void 0===n&&(n=t,t=""),e.util.isPlainObject(n)&&(i=r,r=n,n=t,t=""),"function"==typeof r&&(i=r,r=void 0),e.util.setHide("#"+t+"_loading",!1),e.ajax(n,r).filter(function(n){return n.data?(e.util.isArray(n.data)&&""!==t&&(n.data.length>0?e.util.setHide("#"+t+"_empty"):e.util.setHide("#"+t+"_empty",!1)),n.data):(e.util.setHide("#"+t+"_loading"),!1)}).success(i).bind(t)}}(window.domjs,window.domjs.http,window.domjs.jsonp),function(e){e.validate=function(e,t){if(!e.hasRule)return!0;for(var n=!1,r=0;r<t.length;r++)if(""!==t[r]){n=!0;break}if(!n&&this.hasRequired(e))return""!==e.required?e.required:""!==e.dataMessage&&e.dataMessage;if(n)for(var i in e)if("required"!==i&&!this.validateItem(i,e[i],t))return!1;return!0},e.validateItem=function(e,t,n){for(var r=0;r<n.length;r++)if(this.rule[e]&&!this.rule[e](n[r],t))return!1;return!0},e.hasRequired=function(e){return e.hasOwnProperty("required")},e.rule={},e.rule.pattern=function(e,t){return new RegExp(t,"g").test(e)},e.rule.email=function(t){return e.regex.email.test(t)},e.rule.url=function(t){return e.regex.url.test(t)},e.rule.tel=function(t){return e.regex.tel.test(t)},e.rule.confirm=function(e,t){return e===t},e.rule["data-validate"]=function(t,n){return!e.regex[n]||e.regex[n].test(t)},e.regex={},e.regex.email=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,e.regex.mobile=/^1[34578]{1}\d{9}$/,e.regex.url=/[a-zA-z]+:\/\/[^\s]*/,e.regex.tel=/\d+/}(window.domjs.validate={}),function(e,t,n,r,i){function a(e){this.name=e,this.values=[],this.validateRule={},this.dataMessage=""}a.prototype.getValue=function(){return 1===this.values.length?this.values[0]:0===this.values.length?"":this.values},a.prototype.noValidate=function(){if(n){var e=n.validate(this.validateRule,this.values);if("string"==typeof e)return e;if(!e)return this.dataMessage}return this.clearError(),!1},a.prototype.showError=function(e){var n=this.item;if(""!==t.errorHtml){var i=n.name+"_error",a=document.getElementById(i);if(a)a.innerHTML=e;else{var o=document.createElement("span");o.innerHTML=t.errorHtml,o.children[0].innerHTML=e,o.children[0].id=i,o.children[0].name=i,o=o.children[0],r.insertAfter(o,n)}}"function"==typeof n.focus&&n.focus(),n.attributes["error-to-parent"]&&n.parentElement&&(n=n.parentElement),r.addClass(n,"has-error")},a.prototype.clearError=function(e){var n=this.item;if(""!==t.errorHtml){var i=n.name+"_error",a=document.getElementById(i);a&&(a.innerHTML="")}n.attributes["error-to-parent"]&&n.parentElement&&(n=n.parentElement),r.removeClass(n,"has-error")},t.val=function(n,r){if("string"==typeof n&&""!==n){var i;if("#"===n.substr(0,1)){n=n.substr(1),i=[];var a=document.getElementById(n);a&&i.push(a)}else i=document.getElementsByName(n);if(i&&0!==i.length){var o=this.getItemsValue(i);for(var u in o){var s,l=o[u];return!0===r?!1===(s=l.noValidate())?l.getValue():(s&&t.isAlertError&&e.error(s),void l.showError(s)):l.getValue()}}}},t.getItemsValue=function(e){for(var n,r={},i=0;i<e.length;i++)if(!(n=e[i]).disabled&&n.name){var o;if(r[n.name]?o=r[n.name]:((o=new a(n.name)).item=n,r[n.name]=o),"INPUT"===n.tagName?"radio"===n.type||"checkbox"===n.type?n.checked&&o.values.push(n.value):o.values.push(n.value):"SELECT"===n.tagName?n.selectedIndex>=0&&n.options[n.selectedIndex].value&&o.values.push(n.options[n.selectedIndex].value):o.values.push(n.value),n.attributes.hasOwnProperty("data-message")?""!==n.attributes["data-message"].value&&(o.dataMessage=n.attributes["data-message"].value):n.attributes.hasOwnProperty("placeholder")&&""!==n.attributes.placeholder.value?o.dataMessage=n.attributes.placeholder.value:n.attributes.hasOwnProperty("data-placeholder")&&""!==n.attributes["data-placeholder"].value&&(o.dataMessage=n.attributes["data-placeholder"].value),n.attributes.hasOwnProperty("required")&&(""===n.attributes.required.value?o.validateRule.required=o.dataMessage:o.validateRule.required=n.attributes.required.value,o.validateRule.hasRule=!0),n.attributes.hasOwnProperty("confirm")&&(o.validateRule.confirm=t.val(n.attributes.confirm.value),o.validateRule.hasRule=!0),n.attributes.hasOwnProperty("pattern")&&""!==n.attributes.pattern.value)o.validateRule.pattern=n.attributes.pattern.value,o.validateRule.hasRule=!0;else if(n.attributes.hasOwnProperty("data-validate"))o.validateRule["data-validate"]=n.attributes["data-validate"].value,o.validateRule.hasRule=!0;else if("INPUT"===n.tagName)switch(n.type){case"date":case"datetime":case"month":case"week":case"time":case"email":case"number":case"tel":case"url":o.validateRule[n.type]="",o.validateRule.hasRule=!0}}return r},t.check=function(e){return void 0!==t.getFormParam(e,!0)},t.isAlertError=!0,t.errorHtml="",t.getFormParam=function(n,i){var a,o={},u=0;if(r.isArray(n)){for(;u<n.length;u++){if(void 0===(a=this.val(n[u],i)))return;o[n[u]]=a}return o}if(""===n)return o;var s;if("string"==typeof n?s=document.getElementById(n):"object"==typeof n&&(s=n),!s)return o;var l=[];for(u=0;u<s.length;u++)l.push(s[u]);var c=this.getItemsValue(l);for(var d in c){var f,p=c[d];if(!0===i){if(!1!==(f=p.noValidate()))return f&&t.isAlertError&&e.error(f),void p.showError(f);o[p.name]=p.getValue()}else o[p.name]=p.getValue()}return o}}(window.domjs,window.domjs.form={},window.domjs.validate,window.domjs.util),function(e,t,n){"use strict";window.$scope={},t.$bindKey={},t.syntax={},t.funcs={},t.util={},t.init=function(){var n,r;if(e.hideBind){for(n=e.util.querySelectorAll("[data-repeat]"),r=0;r<n.length;r++)t.util.show(n[r],!1);for(n=e.util.querySelectorAll("[data-bind]"),r=0;r<n.length;r++)t.util.show(n[r],!1)}},t.addFunc=function(e,t){"function"==typeof t&&e&&(this.funcs[e]=t)},e.initFunction.push(t.init)}(window.domjs,window.domjs.template={}),function(e,t,n){"use strict";t.trim=function(e){return"string"==typeof e?e.replace(/\r/g,"").replace(/\n/g,"").replace("　","").trim():t.isPlainObject(e)?t.trim(t.getDefaultValue(e)):String.valueOf(e)},t.setValue=function(e,r){e.tagName;var i=0,a=t.getBindToNameList(e);if(a.length>0)for(i in a){var o=a[i];e.attributes[o]?e.setAttribute(o,r):e[o]=r}else n.bindElementValue(e,r)},t.html=function(e){return e&&"string"==typeof e?(e=e.replace(/<[^<]*>/gi,"")).trim():t.getDefaultValue(e)},t.getName=function(e,n){var r=n[e];switch(typeof r){case"string":case"number":case"boolean":return[e];case"object":if(t.isArray(r))return[e];var i=[];for(var a in r)if(r.hasOwnProperty(a))for(var o=t.getName(a,r),u=0;u<o.length;u++)i.push(e+"."+o[u]);return i;default:return[]}},t.getValue=function(e,n){for(var r=e.split("."),i=n[r.shift()],a=0;i&&a<r.length;a++)i=i[r[a]];return t.getDefaultValue(i)},t.getDefaultValue=function(e){return null===e||void 0===e?"":e},t.getBindToNameList=function(e){var n=e.attributes["data-bind-to"],r=[];if(n&&n.value)for(var i,a=n.value.split(" "),o=0;o<a.length;o++)""!==(i=t.trim(a[o]))&&r.push(i);return r},t.show=function(e,t){e&&(!1!==t?("none"===e.style.display&&(e.style.display=""),n.removeClass(e,"hide")):e.style.display="none")}}(window,window.domjs.template.util,window.domjs.util),function(e,t){"use strict";e.addFunc("default",function(e,t){return void 0===e||void 0===e||""===e||"null"===e?t:e}),e.addFunc("empty",function(e,t,n){return void 0===e||void 0===e||""===e||"null"===e?t:n}),e.addFunc("case",function(e){for(var t=1;t<arguments.length;t+=2)if(e===arguments[t]&&t<arguments.length-1)return arguments[t+1];return arguments[arguments.length-1]}),e.addFunc("format_money",function(e){return parseFloat(e)}),e.addFunc("format_date",function(e,t){"object"!=typeof e&&(e=new Date(parseInt(e))),t||(t="yyyy-MM-dd hh:mm:ss");var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t}),e.addFunc("fixed",function(e,t){return void 0===t&&(t=0),"number"==typeof e?e.toFixed(t):e}),e.addFunc("noFunc",function(){return"没有找到正确的处理函数"}),e.addFunc("repeat",function(e,t){for(var n="",r=0;r<e;r++)n+=t;return n}),e.addFunc("range",function(t,n){var r="";if(n){n=n.replace(/\(/g,"{").replace(/\)/g,"}");var i=e.syntax.buildFunc("range",n);if(i)for(var a=0;a<t.length;a++)r+=i(e,t[a])}return r}),e.addFunc("filter_html",function(t){return e.util.html(t)}),e.addFunc("left",function(e,t,n){var r=0,i="",a=/[^\x00-\xff]/g,o="",u=0;n&&(u=n.length);for(var s=e.replace(a,"**").length,l=0;l<s;l++){if(null!==(o=e.charAt(l).toString()).match(a)?r+=2:r++,r+u>t){u>0&&(i+=n);break}i+=o}return i})}(window.domjs.template),function(e){function t(e){for(var t,i=0,a=0,o=0,u=[];i<e.length;)-1!==(a=e.indexOf("{",i))?(-1===(o=s(e,a,"}"))&&(o=e.length),t=e.substring(a+1,o).trim(),u.push(n(e.substring(i,a))),""!==t&&u.push(r(t))):(u.push(n(e.substring(i))),o=e.length),i=o+1;return u.join("+")}function n(t){return"string"==typeof t?'"'+t.replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace("data-bind-src","src")+'"':e.util.getStringValue(t)}function r(e){var t=!0;if("!"===e[0]&&(e=e.substring(1),t=!1),e){var n=u(e);if(n.length>0)return t?"domjs.template.util.html("+i(n,n.length-1)+")":i(n,n.length-1)}return'""'}function i(e,t){if(1===e.length)return o(e[0]);if(!(t>0))return o(e[0]);for(var n=[],r=0,u="";t>=0;t--){if("|"===e[t]){var s=n.pop();for(r=n.length;r>0;r--)u+=o(n[r-1]);return u=i(e,t-1)+u,a(s)+"("+u+")"}n.push(e[t])}if(n.length>0){for(r=n.length;r>0;r--)u+=o(n[r-1]);return u}return""}function a(t){return t&&t.length>1&&"#"===t.charAt(0)?t.substring(1):e.funcs[t]?'my.funcs["'+t+'"]':"my.funcs.noFunc"}function o(e){var t="";switch(e.charAt(0)){case"+":case"-":case"*":case"/":case"(":case")":case"'":case'"':case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t+=e;break;case"|":t+="+";break;case",":t+=",";break;case"#":t+=e.substring(1);break;default:t+="my.util.getValue('"+e+"',vo)"}return""===t?"''":t}function u(e){for(var t,n=[],r="",i=0,a=0;a<e.length;a++)switch(t=e.charAt(a)){case"|":case",":case"+":case"-":case"*":case"/":""!==r&&(n.push(r),r=""),n.push(t);break;case'"':case"'":""!==r&&(n.push(r),r=""),(i=s(e,a,t))>0&&(n.push(e.substring(a,i+1)),a=i);break;default:t&&" "!==t&&(r+=t)}return""!==r&&n.push(r),n}function s(e,t,n){for(var r=t+1;r<e.length;r++){if(e.charAt(r)===n)return r;if('"'===e.charAt(r)||"'"===e.charAt(r)){if(0===(t=s(e,r,e.charAt(r))))return 0;r=t}}return 0}e.syntax.cache={},e.syntax.buildFunc=function(n,r){var i;try{i=decodeURIComponent(r)}catch(e){i=r}if((i=e.util.trim(i)).length>0){var a="return "+t(i)+";";try{return new Function("my","vo",a)}catch(e){console.log("解析模板"+n+"出错，"+e.message),console.log(a)}}return!1},e.syntax.cacheFunc=function(e,t,n){var r=this.cache[e+"-func-"+t],i={func:r};return r||(r=this.buildFunc(t,n))&&(this.cache[e+"-func-"+t]=r,i.isFirst=!0,i.func=r),i}}(window.domjs.template),function(e,t,n){"use strict";e.bindData=function(r,i){void 0===i&&(i=r,r="__data__"),n.$scope[r]=i;var a=e.util.querySelectorAll("[data-bind]");if(a&&a.length){var o,u,s,l,c;for(o=0;o<a.length;o++)if(u="",c=a[o].attributes["data-bind"].value,"__data__"!==r&&-1!==c.indexOf(".")&&(c=c.substring(r.length+1)),c&&i.hasOwnProperty(c)){a[o].name||(a[o].name=c);var d=t.util.getBindToNameList(a[o]),f=0;if(d.length>0)for(;f<d.length;f++){l=d[f],s=a[o].attributes["data-template"]?a[o].attributes[l].value:a[o].attributes[l]?a[o].attributes[l].value:a[o][l];var p=t.syntax.cacheFunc("bind",s,s);u=p.func?p.func(t,i):"innerHTML"===l?t.util.getValue(c,i):t.util.html(t.util.getValue(c,i))}else if("IMG"===a[o].tagName&&a[o].attributes["data-bind-src"]){var h=t.syntax.cacheFunc("bind",a[o].attributes["data-bind-src"].value,a[o].attributes["data-bind-src"].value);u=h.func?h.func(t,i):t.util.getValue(c,i)}else if(a[o].attributes["data-template"]){s=a[o].attributes["data-template"].value;var g=t.syntax.cacheFunc("bind",s,s);g.func&&(u=g.func(t,i))}else u=t.util.html(t.util.getValue(c,i)),a[o].attributes["data-format-date"]&&(u=t.funcs.format_date(u,a[o].attributes["data-format-date"].value));t.util.setValue(a[o],u),t.util.show(a[o])}}},e.bindName=function(e,n){var r=t.util.querySelectorAll('[data-bind="'+e+'"]');if(r)for(var i=0;i<r.length;i++)t.util.setValue(r[i],n),t.util.show(r[i])},e.bindRepeatData=function(n,r,i,a,o){if(void 0===r&&(r=n,n="data"),r&&e.util.isArray(r))for(var u=e.util.querySelectorAll('[data-repeat="'+n+'"]'),s=0;s<u.length;s++)t.doRepeat(n+"_"+s,r,i,a,o,u[s])},t.doRepeat=function(e,t,n,r,i,a){"string"!=typeof i&&(i=a.innerHTML);var o=this.syntax.cacheFunc("repeat",e,i),u=0;n&&!o.isFirst||(a.innerHTML="");var s=o.func;if(s)if(!0===r)this.appendData(t,0,a,s,n);else{var l="";for(u=0;u<t.length;u++){var c=t[u];c.__index__=u,l+=s(this,c)}this.setRepeatHtml(a,l,n)}},t.appendData=function(e,n,r,i,a){var o=e[n];o.__index__=n,t.setRepeatHtml(r,i(this,o),0!==n||!0===a),++n<e.length&&setTimeout(function(){t.appendData(e,n,r,i,a)},50)},t.setRepeatHtml=function(e,n,r){!0===r?e.innerHTML+=n:e.innerHTML=n,t.util.show(e)}}(window.domjs,window.domjs.template,window);